<html>
<head>
	<!-- prototype stuff -->
	<script type="text/javascript" src="libs/prototype.js"></script>
	<script type="text/javascript" src="libs/effects.js"></script>
	<!-- other libs stuff -->
	<script src="libs/base64.js" type="text/javascript" charset="utf-8"></script>

	<!-- classess -->
	<script src="class/service.js" type="text/javascript" charset="utf-8"></script>
	<script src="class/blip.js" type="text/javascript" charset="utf-8"></script>
	<script src="class/interface.js" type="text/javascript" charset="utf-8"></script>
	<script src="class/updates.js" type="text/javascript" charset="utf-8"></script>

	<!-- szit -->
	<script type="text/javascript" charset="utf-8">
		var blip;
		document.observe('dom:loaded',
			function(){
			$('sender').toggle();
			$('throbber').toggle();
				Element.observe(
					'login_form',
					'submit',
					function(event){
						var username = $F(this['username']);
						var pass = $F(this['pass']);
						try {
							blip = new Blip(username, pass);
							// TODO it works - so make it happen somewhere else
							// idealy would be to have one loop, that just runs stuff
							// but depeneding on different services
							// we might create separate intervals...
							blip.dashboardProcess = Interface.Dashboard.draw;
							var i=0;
							setInterval(function(){
								blip.dashboardGet();
								console.log(i++);
							}, 10000);

						}
						catch(de) { alert(de);}

							this.fade();
							$('throbber').toggle();
							$('sender').toggle();
							event.preventDefault();
					}
				);
				Element.observe('sender_form','submit',function(event){
					var blyp = $F(this['content']);

					blip.createBlip(blyp);
					event.preventDefault();
				});
			});
		
	</script>
	<link rel="stylesheet" href="app://style.css" type="text/css" media="screen" charset="utf-8"/>
</head>
<body>
	<div id="wrapper">


		<div id="dash1" class="column">
			
		</div>
		<form action="#" method="" accept-charset="utf-8" id="login_form">
			<label for="Login">Login</label>
				<input type="text" name="username" value=""/>
			<label for="pass">Has≈Ço</label>
				<input type="password" name="pass" value=""/>
		<p><input type="submit" value="Continue &rarr;"></p>
		</form>
		<div id="sender">
			<form action="#" method="" id="sender_form" accept-charset="utf-8">
				
				<label for="Blip">Blip</label>
				<textarea  id="main_textarea" name="content" rows="3" ></textarea>
			<p><input type="submit" value="Send &rarr;"></p>
			</form>
			
			<div id="throbber"><img src="app://icons/anim.gif" /></div>
		</div>
	</div>
</body>
</html>
